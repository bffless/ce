# Backend Development Guidelines

## Database Migrations

**IMPORTANT**: Always use Drizzle's schema-first approach for migrations:

1. **Never write manual SQL migration files**
   - All schema changes should be made in TypeScript schema files (`src/db/schema/*.schema.ts`)
   - Use `pnpm db:generate` to create migrations from schema changes
   - This ensures snapshots and journal stay in sync

2. **Migration workflow**:
   ```bash
   # 1. Update schema files in src/db/schema/
   # 2. Generate migration
   pnpm db:generate
   # 3. Review generated SQL in drizzle/*.sql
   # 4. Apply migration
   pnpm db:migrate
   ```

3. **Why?**
   - Manual SQL migrations break Drizzle's snapshot tracking
   - Schema files are the source of truth
   - Type safety and IDE autocomplete from schema definitions

## Exception

The only time to write manual SQL is for data migrations (UPDATE/INSERT statements), not schema changes (CREATE/ALTER TABLE).
